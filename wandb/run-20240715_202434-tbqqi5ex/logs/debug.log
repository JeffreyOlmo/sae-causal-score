2024-07-15 20:24:35,002 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Configure stats pid to 12524
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Loading settings from /mnt/pccfs2/backed_up/jeffolmo/sae_functional_significance/wandb/settings
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program': '<python with no main file>'}
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_init.py:_log_setup():521] Logging user logs to /mnt/pccfs2/backed_up/jeffolmo/sae_functional_significance/wandb/run-20240715_202434-tbqqi5ex/logs/debug.log
2024-07-15 20:24:35,003 INFO    MainThread:12524 [wandb_init.py:_log_setup():522] Logging internal logs to /mnt/pccfs2/backed_up/jeffolmo/sae_functional_significance/wandb/run-20240715_202434-tbqqi5ex/logs/debug-internal.log
2024-07-15 20:24:35,004 INFO    MainThread:12524 [wandb_init.py:_jupyter_setup():467] configuring jupyter hooks <wandb.sdk.wandb_init._WandbInit object at 0x7f54fd5cb850>
2024-07-15 20:24:35,004 INFO    MainThread:12524 [wandb_init.py:init():561] calling init triggers
2024-07-15 20:24:35,004 INFO    MainThread:12524 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'model_name': 'gpt2-small', 'model_class_name': 'HookedTransformer', 'hook_name': 'blocks.8.hook_resid_pre', 'hook_eval': 'NOT_IN_USE', 'hook_layer': 8, 'hook_head_index': None, 'dataset_path': 'apollo-research/Skylion007-openwebtext-tokenizer-gpt2', 'dataset_trust_remote_code': True, 'streaming': True, 'is_dataset_tokenized': True, 'context_size': 256, 'use_cached_activations': False, 'cached_activations_path': None, 'architecture': 'standard', 'd_in': 768, 'd_sae': 24576, 'b_dec_init_method': 'geometric_median', 'expansion_factor': 32, 'activation_fn': 'relu', 'normalize_sae_decoder': True, 'noise_scale': 0.0, 'from_pretrained_path': None, 'apply_b_dec_to_input': True, 'decoder_orthogonal_init': False, 'decoder_heuristic_init': False, 'init_encoder_as_decoder_transpose': False, 'n_batches_in_buffer': 20, 'training_tokens': 10000000, 'finetuning_tokens': 0, 'store_batch_size_prompts': 32, 'train_batch_size_tokens': 4096, 'normalize_activations': 'none', 'device': 'cuda', 'act_store_device': 'cuda', 'seed': 42, 'dtype': 'float32', 'prepend_bos': True, 'autocast': False, 'autocast_lm': False, 'compile_llm': False, 'llm_compilation_mode': None, 'compile_sae': False, 'sae_compilation_mode': None, 'adam_beta1': 0, 'adam_beta2': 0.999, 'mse_loss_normalization': None, 'l1_coefficient': 0.005, 'lp_norm': 1.0, 'scale_sparsity_penalty_by_decoder_norm': False, 'l1_warm_up_steps': 0, 'lr': 1e-05, 'lr_scheduler_name': 'cosine', 'lr_warm_up_steps': 0, 'lr_end': 1.0000000000000002e-06, 'lr_decay_steps': 0, 'n_restart_cycles': 1, 'finetuning_method': None, 'use_ghost_grads': False, 'feature_sampling_window': 2000, 'dead_feature_window': 1000, 'dead_feature_threshold': 1e-08, 'n_eval_batches': 10, 'eval_batch_size_prompts': None, 'log_to_wandb': True, 'log_activations_store_to_wandb': False, 'log_optimizer_state_to_wandb': False, 'wandb_project': 'sae_finetuning_r_score', 'wandb_id': None, 'run_name': '24576-L1-0.005-LR-1e-05-Tokens-1.000e+07', 'wandb_entity': None, 'wandb_log_frequency': 10, 'eval_every_n_wandb_logs': 100, 'resume': False, 'n_checkpoints': 5, 'checkpoint_path': './checkpoints/ay6vq4yd', 'verbose': True, 'model_kwargs': {}, 'model_from_pretrained_kwargs': {}, 'sae_lens_version': '3.7.0', 'sae_lens_training_version': '3.7.0', 'tokens_per_buffer': 20971520}
2024-07-15 20:24:35,005 INFO    MainThread:12524 [wandb_init.py:init():611] starting backend
2024-07-15 20:24:35,005 INFO    MainThread:12524 [wandb_init.py:init():615] setting up manager
2024-07-15 20:24:35,012 INFO    MainThread:12524 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-07-15 20:24:35,013 INFO    MainThread:12524 [wandb_init.py:init():623] backend started and connected
2024-07-15 20:24:35,028 INFO    MainThread:12524 [wandb_run.py:_label_probe_notebook():1299] probe notebook
2024-07-15 20:24:35,029 INFO    MainThread:12524 [wandb_run.py:_label_probe_notebook():1309] Unable to probe notebook: 'NoneType' object has no attribute 'get'
2024-07-15 20:24:35,029 INFO    MainThread:12524 [wandb_init.py:init():715] updated telemetry
2024-07-15 20:24:35,034 INFO    MainThread:12524 [wandb_init.py:init():748] communicating run to backend with 90.0 second timeout
2024-07-15 20:24:35,512 INFO    MainThread:12524 [wandb_run.py:_on_init():2357] communicating current version
2024-07-15 20:24:35,673 INFO    MainThread:12524 [wandb_run.py:_on_init():2366] got version response upgrade_message: "wandb version 0.17.4 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-07-15 20:24:35,673 INFO    MainThread:12524 [wandb_init.py:init():799] starting run threads in backend
2024-07-15 20:24:36,272 INFO    MainThread:12524 [wandb_run.py:_console_start():2335] atexit reg
2024-07-15 20:24:36,273 INFO    MainThread:12524 [wandb_run.py:_redirect():2190] redirect: wrap_raw
2024-07-15 20:24:36,273 INFO    MainThread:12524 [wandb_run.py:_redirect():2255] Wrapping output streams.
2024-07-15 20:24:36,273 INFO    MainThread:12524 [wandb_run.py:_redirect():2280] Redirects installed.
2024-07-15 20:24:36,275 INFO    MainThread:12524 [wandb_init.py:init():842] run started, returning control to user process
2024-07-15 20:24:36,381 INFO    MainThread:12524 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-07-15 20:24:36,381 INFO    MainThread:12524 [wandb_init.py:_pause_backend():432] pausing backend
2024-07-15 20:27:26,749 INFO    MainThread:12524 [wandb_init.py:_resume_backend():437] resuming backend
2024-07-15 20:27:27,099 INFO    MainThread:12524 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-07-15 20:27:27,099 INFO    MainThread:12524 [wandb_init.py:_pause_backend():432] pausing backend
2024-07-15 20:30:19,211 INFO    MainThread:12524 [wandb_init.py:_resume_backend():437] resuming backend
2024-07-15 20:30:19,603 INFO    MainThread:12524 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-07-15 20:30:19,603 INFO    MainThread:12524 [wandb_init.py:_pause_backend():432] pausing backend
2024-07-15 20:30:57,190 INFO    MainThread:12524 [wandb_init.py:_resume_backend():437] resuming backend
2024-07-15 20:30:57,195 INFO    MainThread:12524 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-07-15 20:30:57,195 INFO    MainThread:12524 [wandb_init.py:_pause_backend():432] pausing backend
2024-07-15 20:31:07,130 INFO    MainThread:12524 [wandb_init.py:_resume_backend():437] resuming backend
2024-07-15 20:31:07,495 INFO    MainThread:12524 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-07-15 20:31:07,495 INFO    MainThread:12524 [wandb_init.py:_pause_backend():432] pausing backend
2024-07-15 20:31:17,498 INFO    MainThread:12524 [wandb_init.py:_resume_backend():437] resuming backend
2024-07-15 20:31:23,818 INFO    MainThread:12524 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-07-15 20:31:23,818 INFO    MainThread:12524 [wandb_init.py:_pause_backend():432] pausing backend
2024-07-15 20:31:37,145 INFO    MainThread:12524 [wandb_init.py:_resume_backend():437] resuming backend
2024-07-15 20:31:37,170 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Current SDK version is 0.16.6
2024-07-15 20:31:37,170 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Configure stats pid to 12524
2024-07-15 20:31:37,170 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-07-15 20:31:37,170 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Loading settings from /mnt/pccfs2/backed_up/jeffolmo/sae_functional_significance/wandb/settings
2024-07-15 20:31:37,170 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-07-15 20:31:37,170 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program': '<python with no main file>'}
2024-07-15 20:31:37,170 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2024-07-15 20:31:37,171 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Applying login settings: {'api_key': '***REDACTED***'}
2024-07-15 20:31:37,171 INFO    MainThread:12524 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-07-15 20:31:37,171 INFO    MainThread:12524 [wandb_init.py:_log_setup():521] Logging user logs to /mnt/pccfs2/backed_up/jeffolmo/sae_functional_significance/wandb/run-20240715_203137-aazwogvg/logs/debug.log
2024-07-15 20:31:37,171 INFO    MainThread:12524 [wandb_init.py:_log_setup():522] Logging internal logs to /mnt/pccfs2/backed_up/jeffolmo/sae_functional_significance/wandb/run-20240715_203137-aazwogvg/logs/debug-internal.log
2024-07-15 20:31:37,171 INFO    MainThread:12524 [wandb_init.py:init():561] calling init triggers
2024-07-15 20:31:37,171 INFO    MainThread:12524 [wandb_init.py:init():568] wandb.init called with sweep_config: {}
config: {'model_name': 'gpt2-small', 'model_class_name': 'HookedTransformer', 'hook_name': 'blocks.8.hook_resid_pre', 'hook_eval': 'NOT_IN_USE', 'hook_layer': 8, 'hook_head_index': None, 'dataset_path': 'apollo-research/Skylion007-openwebtext-tokenizer-gpt2', 'dataset_trust_remote_code': True, 'streaming': True, 'is_dataset_tokenized': True, 'context_size': 256, 'use_cached_activations': False, 'cached_activations_path': None, 'architecture': 'standard', 'd_in': 768, 'd_sae': 24576, 'b_dec_init_method': 'geometric_median', 'expansion_factor': 32, 'activation_fn': 'relu', 'normalize_sae_decoder': True, 'noise_scale': 0.0, 'from_pretrained_path': None, 'apply_b_dec_to_input': True, 'decoder_orthogonal_init': False, 'decoder_heuristic_init': False, 'init_encoder_as_decoder_transpose': False, 'n_batches_in_buffer': 20, 'training_tokens': 10000000, 'finetuning_tokens': 0, 'store_batch_size_prompts': 32, 'train_batch_size_tokens': 4096, 'normalize_activations': 'none', 'device': 'cuda', 'act_store_device': 'cuda', 'seed': 42, 'dtype': 'float32', 'prepend_bos': True, 'autocast': False, 'autocast_lm': False, 'compile_llm': False, 'llm_compilation_mode': None, 'compile_sae': False, 'sae_compilation_mode': None, 'adam_beta1': 0, 'adam_beta2': 0.999, 'mse_loss_normalization': None, 'l1_coefficient': 0.005, 'lp_norm': 1.0, 'scale_sparsity_penalty_by_decoder_norm': False, 'l1_warm_up_steps': 0, 'lr': 1e-05, 'lr_scheduler_name': 'cosine', 'lr_warm_up_steps': 0, 'lr_end': 1.0000000000000002e-06, 'lr_decay_steps': 0, 'n_restart_cycles': 1, 'finetuning_method': None, 'use_ghost_grads': False, 'feature_sampling_window': 2000, 'dead_feature_window': 1000, 'dead_feature_threshold': 1e-08, 'n_eval_batches': 10, 'eval_batch_size_prompts': None, 'log_to_wandb': True, 'log_activations_store_to_wandb': False, 'log_optimizer_state_to_wandb': False, 'wandb_project': 'sae_finetuning_r_score', 'wandb_id': None, 'run_name': '24576-L1-0.005-LR-1e-05-Tokens-1.000e+07', 'wandb_entity': None, 'wandb_log_frequency': 10, 'eval_every_n_wandb_logs': 100, 'resume': False, 'n_checkpoints': 5, 'checkpoint_path': './checkpoints/0nys35qu', 'verbose': True, 'model_kwargs': {}, 'model_from_pretrained_kwargs': {}, 'sae_lens_version': '3.7.0', 'sae_lens_training_version': '3.7.0', 'tokens_per_buffer': 20971520}
2024-07-15 20:31:37,172 INFO    MainThread:12524 [wandb_init.py:init():586] re-initializing run, found existing run on stack: tbqqi5ex
2024-07-15 20:31:37,174 INFO    MainThread:12524 [wandb_run.py:_finish():2064] finishing run jeffreyjolmo-byu/sae_finetuning_r_score/tbqqi5ex
2024-07-15 20:31:37,174 INFO    MainThread:12524 [jupyter.py:save_history():445] not saving jupyter history
2024-07-15 20:31:37,174 INFO    MainThread:12524 [jupyter.py:save_ipynb():373] not saving jupyter notebook
2024-07-15 20:31:37,174 INFO    MainThread:12524 [wandb_init.py:_jupyter_teardown():449] cleaning up jupyter logic
2024-07-15 20:31:37,174 INFO    MainThread:12524 [wandb_run.py:_atexit_cleanup():2304] got exitcode: 0
2024-07-15 20:31:37,174 INFO    MainThread:12524 [wandb_run.py:_restore():2287] restore
2024-07-15 20:31:37,174 INFO    MainThread:12524 [wandb_run.py:_restore():2293] restore done
2024-07-15 20:31:43,929 INFO    MainThread:12524 [wandb_run.py:_footer_history_summary_info():3936] rendering history
2024-07-15 20:31:43,930 INFO    MainThread:12524 [wandb_run.py:_footer_history_summary_info():3968] rendering summary
2024-07-15 20:31:43,937 INFO    MainThread:12524 [wandb_run.py:_footer_sync_info():3895] logging synced files
